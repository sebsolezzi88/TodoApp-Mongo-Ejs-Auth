<%- include("partials/header") %>

<div class="flex items-center justify-center mt-6">


 <div class="bg-white p-8 rounded-xl shadow-lg w-full max-w-2xl">
        <!-- Mostrar mensajes -->
            <% if ( alert ) { %>
                <div
                    class="<%= alert.status === 'success' ? 'bg-green-100 text-green-800 border border-green-300' : 'bg-red-100 text-red-800 border border-red-300' %> px-4 py-2 rounded mb-4">
                    <%= alert.msg %>
                </div>
                <% } %>
            <!-- Fin de mostrar mensajes -->
        <h1 class="text-3xl font-bold text-emerald-800 mb-6 text-center">Tareas de <span class="text-teal-600"><%= username %></span></h1>

        <!-- Botón para agregar nueva tarea -->
        <div class="mb-6 text-right">
            <a href="/tarea/nueva" class="inline-block bg-emerald-600 text-white font-bold py-2 px-4 rounded-lg hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-500 transition duration-300">
                ➕ Agregar Nueva Tarea
            </a>
        </div>

        <% if (tasks.length === 0) { %>
            <!-- Mensaje si no hay tareas (inicialmente oculto) -->
        <div class="text-center text-gray-500 mb-6">
            <p class="text-lg">Aún no tienes tareas. ¡Haz clic en "Agregar Nueva Tarea" para empezar!</p>
        </div>
        <% } else { %>
            <!-- Contenedor de tareas -->
        <div id="tasks-container" class="space-y-4">
            
            <% tasks.forEach(task => { %>
                
                <div class="bg-gray-50 p-4 rounded-lg shadow-sm border border-gray-200 flex flex-col sm:flex-row justify-between items-start sm:items-center">
                    <div class="flex-grow mb-3 sm:mb-0">
                        <h2 class="text-xl font-semibold text-gray-800"><%= task.title %></h2>
                        <p class="text-gray-600 text-sm"><%= task.text %></p>
                        <div class="flex flex-wrap gap-2 mt-2">
                            <span class="inline-block px-3 py-1 text-xs font-semibold text-blue-800 bg-blue-100 rounded-full">Pendiente</span>
                            <span class="inline-block px-3 py-1 text-xs font-semibold rounded-full <%=
                                    task.priority === 'Baja'
                                        ? 'text-green-800 bg-green-100'
                                        : task.priority === 'Media'
                                        ? 'text-yellow-800 bg-yellow-100'
                                        : 'text-red-800 bg-red-100'
                                    %>"
                                >
                                Prioridad: <%= task.priority %>
                            </span>
                        </div>
                    </div>
                    <div class="flex space-x-2">
                        <a href="/tarea/editar/<%= task._id %>"  class="bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition duration-300 text-sm">Editar</a>
                        <form action="/tarea/borrar/<%= task._id %>?_method=DELETE" method="POST">
                            <button type="submit" class="bg-red-500 text-white py-2 px-4 rounded-lg hover:bg-red-600 transition duration-300 text-sm">
                             Eliminar
                            </button>
                        </form>
                    </div>
                </div>

            <% }) %>
          
        </div>
        <!-- Fin Contenedor de tareas -->
        <% } %>
        
    </div>
    </div>

